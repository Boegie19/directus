name: Build
description: Build the platform
inputs:
  build:
    description: Build the production bundle of the platform
    required: false
    default: 'true'
runs:
  using: composite
  steps:
    - name: ‚ôªÔ∏è Restore build cache
      uses: actions/cache@v3
      id: pnpm-build-cache
      with:
        path: '**/dist'
        key: pnpm-build-cache-${{ github.sha }}

    - name: üì• Build
      if: ${{ steps.pnpm-build-cache.outputs.cache-hit != 'true' && inputs.build == 'true' }}
      shell: bash
      run: pnpm run build
      env:
        npm_config_workspace_concurrency: '1'
        NODE_OPTIONS: --max_old_space_size=6144